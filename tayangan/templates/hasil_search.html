{% extends 'base.html' %}

{% block content %}
{% include 'navbar.html' %}
<style>
    @import url('https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap');

    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        background: linear-gradient(to bottom, #bb301a, #ed7e59);
        font-family: 'Lato', sans-serif;
    }
    .container {
        margin-top: 50px;
    }

    .search-bar {
        margin-bottom: 20px;
    }
    .button-custom {
        background-color: rgba(28, 15, 15, 0.569);
        color: white;
        border: none;
        padding: 10px 20px;
        margin: 5px 0;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }
    h1, h2 {
        color: white;
    }

    .search-input {
        width: 50%;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #ddd;
    }
    .search-button {
        padding: 10px 20px;
        border-radius: 20px;
        background-color: white;
        color: black;
        border: 1px solid #ddd;
        cursor: pointer;
        font-size: 16px;
    }
    table {
        width: 100%;
        background-color: #fff;
        color: #54362d;
        border-collapse: collapse;
        margin-bottom: 20px;
    }
    table, th, td {
        border: 1px solid #ddd;
    }
    th, td {
        padding: 10px;
        text-align: left;
    }
</style>

<div class="container mt-5">
    <h1 class="title">HASIL PENCARIAN</h1>

    <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Judul tayangan" aria-label="Judul tayangan" id="searchBar">
        <button class="btn btn-primary" type="button" id="search">Search</button>
    </div>

    {% if tayangan %}
    <table class="table">
        <thead>
        <tr>
            <th scope="col">Judul</th>
            <th scope="col">Sinopsis Trailer</th>
            <th scope="col">URL Trailer</th>
            <th scope="col">Tanggal Rilis Trailer</th>
            <th scope="col">Tayangan</th>
        </tr>
        </thead>
        <tbody>
        {% for item in tayangan %}
        <tr>
            <td>{{ item.judul }}</td>
            <td>{{ item.sinopsis_trailer }}</td>
            <td>{{ item.url_video_trailer }}</td>
            <td>{{ item.release_date_trailer }}</td>
            <td>
                {% if paket.is_valid == 1 %}
                <a href="/tayangan/film/{{ item.id }}" class="text-white hover:text-gray-300 me-2">
                    <button type="button" class="btn btn-primary mb-2">Tombol ke Tayangan</button>
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">Tidak ditemukan tayangan yang sesuai</div>
    {% endif %}
</div>

<script>
    document.getElementById('search').addEventListener('click', function() {
        const searchValue = document.getElementById('searchBar').value;
        const encodedValue = encodeURIComponent(searchValue).replace(/'/g, "%27");
        const searchUrl = "{% url 'hasil_search' search_value %}".replace('search_value', encodedValue);
        window.location.href = searchUrl; // Menetapkan URL baru
    });
</script>
{% endblock content %}