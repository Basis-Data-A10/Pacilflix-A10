{% extends 'base.html' %}

{% block content %}
{% include 'navbar.html' %}
<style>
    html, body {
        height: 100%; /* Mengatur tinggi html dan body */
        margin: 0;
        padding: 0;
        width: 100%; /* Mengatur lebar html dan body */
    }

    body {
        background: linear-gradient(to bottom,#bb301a, #ed7e59); /* Gradient diterapkan ke body */
        display: flex;
        flex-direction: column; /* Membantu mengatur flow isi secara vertikal */
        font-family: 'Lato', sans-serif;
    }

    .container {
        flex: 1; /* Membuat container mengisi ruang yang tersedia */
        width: 80%;
        margin: auto;
        padding-top: 50px;
    }

    .table-custom {
        border-collapse: collapse;
        width: 100%;
        border-radius: 10px;
        overflow: hidden;
        background-color: #ffffff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.543);
    }

    .table-custom th, .table-custom td {
        border: 1px solid #ddd;
        padding: 8px;
    }

    .table-custom th {
        background-color: rgba(23, 9, 9, 0.809);
        color: white;
        font-weight: 700;
    }

    .table-custom td {
        font-weight: 400;
    }

    .search-bar {
        margin: 20px 0;
    }

    .search-input {
        width: 50%;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #ddd;
    }

    .search-button {
        padding: 10px 20px;
        border-radius: 5px;
        background-color: rgba(0,0,0,0.1);
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
    }
</style>

<div class="container mt-5">
    <h1 class="title">HASIL PENCARIAN</h1>

    <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Judul tayangan" aria-label="Judul tayangan" id="searchBar">
        <button class="btn btn-primary" type="button" id="search">Search</button>
    </div>

    {% if tayangan %}
    <table class="table">
        <thead>
        <tr>
            <th scope="col">Judul</th>
            <th scope="col">Sinopsis Trailer</th>
            <th scope="col">URL Trailer</th>
            <th scope="col">Tanggal Rilis Trailer</th>
            <th scope="col">Tayangan</th>
        </tr>
        </thead>
        <tbody>
        {% for item in tayangan %}
        <tr>
            <td>{{ item.judul }}</td>
            <td>{{ item.sinopsis_trailer }}</td>
            <td>{{ item.url_video_trailer }}</td>
            <td>{{ item.release_date_trailer }}</td>
            <td>
                {% if paket.is_valid == 1 %}
                <a href="/tayangan/film/{{ item.id }}" class="text-white hover:text-gray-300 me-2">
                    <button type="button" class="btn btn-primary mb-2">Tombol ke Tayangan</button>
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty">Tidak ditemukan tayangan yang sesuai</div>
    {% endif %}
</div>

<script>
    document.getElementById('search').addEventListener('click', function() {
        const searchValue = document.getElementById('searchBar').value;
        const encodedValue = encodeURIComponent(searchValue).replace(/'/g, "%27");
        const searchUrl = `hasil-pencarian-tayangan/${encodedValue}/`;
        window.location.href = ''; // Mengosongkan URL yang ada
        window.location.href = searchUrl; // Menetapkan URL baru
    });
</script>
{% endblock content %}